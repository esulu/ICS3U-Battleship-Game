/*
 Eren Sulutas
 05/31/2017
 ICS3U
 Summative - Game Design
 Battleship
 This program is a playable version of the board game Battleship made in Java 
 */

class Battleship 
{
  public static void main(String[] args)
  {
    
    // Main method will act as the main connector of different methods 
    // Gives the user some options on whether they want to play or see the rulse 
    
    playGame();
  }
  
  public static void printRules()
  {
    
    // Displays the instructions on how to play the game to the user 
    
  }
  
  public static void playGame()
  {
    
    // Method where most of the gameplay will be handled  
    
    int[][] board = new int[9][9]; // Initializes an 8x8 game board
    int[][] board2 = new int[9][9];
    
    printBoard(board, board2);
    board = userSetup();
    printBoard(board, board2);
    
    
  }
  
  public static void printBoard(int board[][], int board2[][])
  {
    
    // Method used to print the playing board when updated 
    
    String[] numbers = {" ", "1", "2", "3", "4", "5", "6", "7", "8"};
    String[] letters = {" ", "A", "B", "C", "D", "E", "F", "G", "H"};
    
    System.out.println("      Defense\t      Offense");
    
    // Fills the boards
    for (int y = 0; y < 9; y ++) {
      for (int x = 0; x < 9; x ++){ // Board 1
        if (x == 0) { // Letters for the first column 
          System.out.print(letters[y]);
        } else if (y == 0) { // Numbers for the first row
          System.out.print(numbers[x]);
        } else if (board[y][x] == 0) { // Empty board spaces              
          System.out.print("~");
        } else if (board[y][x] == 1) { // Missed CPU shot 
          System.out.print("O");
        } else if (board[y][x] == 2) { // CPU hit 
          System.out.print("X");
        } else if (board[y][x] == 3) { // Sunken user ship
          System.out.print("|");
        } else if (board[y][x] == 4) { // User ship
          System.out.print("#");
        }
        System.out.print(" "); // Spacing 
      }
      for (int x = 0; x < 9; x ++){ // Board 2
        if (x == 0) { // Letters for the first column 
          System.out.print("\t" + letters[y]);
        } else if (y == 0) { // Numbers for the first row
          System.out.print(numbers[x]);
        } else if (board2[y][x] == 0) { // Empty board spaces              
          System.out.print("~"); 
        } else if (board2[y][x] == 1) { // Missed user shot 
          System.out.print("O");
        } else if (board2[y][x] == 2) { // User hit 
          System.out.print("X"); 
        } else if (board2[y][x] == 3) { // Sunken CPU ship
          System.out.print("|");
        }
        System.out.print(" "); // Spacing   
      }
      System.out.println(); // New lines 
    } 
    
  }
  
  public static int[][] userSetup() //void userSetup()
  {
    
    // Method where the user makes their initial ship setup 
    int[][] board = new int[9][9];
    int[] entry1 = new int[3]; // Arrays to hold the inital coordinates of the ships 
    int shipSize;
    
    System.out.println("\nShip placements: ");
    System.out.println("The coordinate you enter will be the upper left of the ship.");
    System.out.println("Entry must be entered in the following format: <(V)ertical/(H)orizontal> <Y-Axis> <X-Axis> Examples: VC5, HG5");
    System.out.println("Enter the coordinates to place your Battleship (1x4). Ex: HA4");
    entry1 = lettersToInt(); // User entry is handled in the lettersToInt method 
    shipSize = 4; // Indicates the ship size (in this case 4 long)
    
    System.out.println(entry1[0]);
    System.out.println(entry1[1]);
    System.out.println(entry1[2]);
    
    board = setupUserError(entry1, board, shipSize); // Sends some variables to the setupUserError method to check if the ship is illegally placed 

    return board;
    
  }
  
  public static void cpuSetup()
  {
    
    // Method where the computer makes their initial ship setup 
    
  }
  
  public static int[] lettersToInt()
  {
    
    // Method to convert the coordinate values to integers 
    
    String input;
    boolean validEntry = false;
    int y = 0; 
    int x = 0;
    int[] coordinates = new int[3];
    
    
    
    do {
      input = In.getString(); // User input 
      if (input.length() == 3) { // Checks if the input is 3 characters long 
        char position = input.charAt(0);
        char yChar = input.charAt(1);
        char xChar = input.charAt(2);
        position = Character.toLowerCase(position);
        yChar = Character.toLowerCase(yChar);
        if ((position == 'v' || position == 'h') && (yChar >= 'a' && yChar <= 'h') && (xChar >= '1' && xChar <= '8')) { // Checks if the user entered a v/h position,  the y-coordinate is a letter from a-h and if the x-coordinate is a number from 1-8
          // Checks if the user entered a veritical position 
          if (position == 'v') { 
            coordinates[0] = 1;
          } else { // User entered a horizontal position
            coordinates[0] = 2;
          }
          y = yChar - 'a' + 1; // Converts the y char value to an int
          x = Character.getNumericValue(xChar); // Converts the x char value to an int 
          validEntry = true;
        } else { // Invalid input 
          System.out.println("Error: Invalid coordinates. Please enter new coordinates. Ex: HA4");
        }
      } else { // Entry is not 3 characters long 
        System.out.println("Error: Entry must be 3 characters long. Ex: VH6");
      }
    } while (validEntry == false);  // Loops until the user enters a valid coordinate
    
    
    
    coordinates[1] = y;
    coordinates[2] = x;
    
    return coordinates;
    
    
  }
  
  public static int[][] setupUserError(int[] entry, int[][] board, int shipSize)//boolean setupUserError()
  {
    
    // Method which checks if suer boats overlap or are placed in invalid locations
    boolean added = false; 
    
    // Loops until the ship has been added 
    while(!added) {
      
      if (entry[0] == 2) {  // Checks for available horizontal space for the ship
        
        boolean hasSpace = true;
        
        for (int i = 0; i < shipSize; i ++) {
          // Checks if the ship fits on the board horizontally (Does not go out of bounds)
          if (entry[2] + i >= 9) {
            // Ship goes out of the board 
            hasSpace = false;
            break; 
          }
          if (board[entry[1]][entry[2]+i] != 0) {
            // Checks if this area is occupied by another ship
            hasSpace = false;
            break;
          }
        }
        if (!hasSpace) { 
          // Method continues if there is no space for the ship
          continue;
        }
        for (int i = 0; i < shipSize; i++) {
          board[entry[1]][entry[2]+i] = 4; // Sets the position values to 4 which indicates a ship
        }
        added = true;
        
      } else {  // Checks for available veritical space for the ship
        
        boolean hasSpace = true;
        
        for (int i = 0; i < shipSize; i++) {
          // Checks if the ship fits on the board vertically (Does not go out of bounds)
          if (entry[1] + i >= 9) { 
            // Ship goes out of the board 
            hasSpace = false;
            break;
          }
          if (board[entry[1]+i][entry[2]] != 0) {
            // Checks if this area is occupied by another ship
            hasSpace = false;
            break;
          }
        }
        if (!hasSpace) {
          // Method continues if there is no space for the ship
          continue;
        }
        for (int i = 0; i < shipSize; i++) {
          board[entry[1]+i][entry[2]] = 4; // Sets the position values to 4 which indicates a ship
        }
        added = true;
      }
    }
    
    return board;
    
  }
  
  public static void b()//boolean setupCpuError()
  {
    
    // Method which checks if computer boats overlap or are placed in invalid locations
    
  }
  
  public static void c()//int userChoice()
  {
    
    // Method which handles the user choice of attack
    
  }
  public static void d()// int cpuChoice()
  {
    
    // Method which handles the computer choice of attack 
    
  }
  
  public static void printScore()
  {
    
    // Method used to display the score 
    
  }
  
}
